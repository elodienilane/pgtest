<!DOCTYPE html>
<!--[if IEMobile 7 ]>    <html class="no-js iem7"> <![endif]-->
<!--[if (gt IEMobile 7)|!(IEMobile)]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <title></title>
        <meta name="description" content="">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="viewport" content="width-device-width, user-scalable=no">
        <meta http-equiv="cleartype" content="on">

        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="img/touch/apple-touch-icon-144x144-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="img/touch/apple-touch-icon-114x114-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="img/touch/apple-touch-icon-72x72-precomposed.png">
        <link rel="apple-touch-icon-precomposed" href="img/touch/apple-touch-icon-57x57-precomposed.png">
        <link rel="shortcut icon" href="img/touch/apple-touch-icon.png">

        <!-- For iOS web apps. Delete if not needed. https://github.com/h5bp/mobile-boilerplate/issues/94 -->
        <!--
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        -->
        
        <!-- This script prevents links from opening in Mobile Safari. https://gist.github.com/1042026 -->
        <!--
        <script>(function(a,b,c){if(c in b&&b[c]){var d,e=a.location,f=/^(a|html)$/i;a.addEventListener("click",function(a){d=a.target;while(!f.test(d.nodeName))d=d.parentNode;"href"in d&&(d.href.indexOf("http")||~d.href.indexOf(e.host))&&(a.preventDefault(),e.href=d.href)},!1)}})(document,window.navigator,"standalone")</script>
        -->

        <link rel="stylesheet" href="normalize.css">
        <link rel="stylesheet" href="main.css">
                
        <script src="js/vendor/modernizr-2.6.1.min.js"></script>
        <script src="js/helper.js"></script>
        <script src="http://gettopup.com/releases/latest/top_up-min.js" type="text/javascript"></script>
        <!--<script src="js/vendor/jquery-1.7.2.min.js"></script>-->
        
        <script>
            parseJson();
			
            postsArray = [];
			templateClass = "template";
			indexes = [];
			shownTemplates = [];
			unique = 0;
			chunkHeight = 0;
			chunkWidth = 0;
			numberTemplates = 4;
            <!-- Parse Json to get all posts and images -->
            function parseJson(){
				var ipAddress = "172.18.171.148";
                $.get("http://"+ipAddress+":8080/PortFolio/wordpress/?json=get_recent_posts&dev=1", function(json){
                    var deJson = jQuery.parseJSON(json);
                    var posts = deJson.posts;
                    var count = deJson.count;
                    
                    $.each(posts, function( intIndex, post ){
                        var images = post.attachments[0].images;
                        var postVal = {
                                        title       : post.title, 
                                        fullimg     : (images.full.url).replace("localhost", ipAddress),
                                        smallthumb  : images.smallthumb.url.replace("localhost", ipAddress),
                                        bigthumb    : images.bigthumb.url.replace("localhost", ipAddress),
                                        widethumb   : images.widethumb.url.replace("localhost", ipAddress),
                                        highthumb   : images.highthumb.url.replace("localhost", ipAddress)
                                    };
                        postsArray.push(postVal);
                        indexes.push({intIndex : 0});
                    });
                    
					$("#thumbs-container td").each(function(index, element) {
                        newTemplate(element.getAttribute("id"));
                    });
					jQuery(window).scrollTop(500);
					jQuery(window).scrollLeft(500);

                });
            }
            
            <!--Check if all templates have been loaded before generating wall-->            
            function newTemplate(tdID) {
				unique++;
				var templateID = "template"+unique;
				var min = 1;
				var max = numberTemplates;
                var tID = Math.floor(Math.random() * (max - min + 1)) + min;

				var toLoad = "templates/template"+tID+".html";
				var currentposition = $(window).scrollTop();
				var docHeight = $(document).height();
				$.ajax({
					url: toLoad,
					type: "GET",
					datatype: 'html',
					async: false,
					success: function (response) {
						if(postsArray.length == 0){
							alert("No content to display");
						} else {
							var newdiv = document.createElement('div');
							newdiv.className = templateClass;
							newdiv.setAttribute("id", templateID);
							newdiv.innerHTML = response;
							$("#"+tdID).html(newdiv);
			                generateWall(postsArray, indexes, templateID);
						}
					}
				});
            }
            
            <!--Generate template -->
            function generateWall(postsArray, indexes, container){
                var count = postsArray.length;

                var tdsmallcount = 0;
                var tdbigcount = 0;
                var tdwidecount = 0;
                var tdhighcount = 0;
                
                var min = 0;
                var toChoose = [];
                
                for(i = 0; i<count; i++){
                    toChoose.push(i);
                }

                var classT = "#"+container;
                
                $(classT).find("td").each(function(index) { //get all cells in table
                    var source = null;
                    
                    var max = toChoose.length - 1;
                    var index = Math.floor(Math.random() * (max - min + 1)) + min;
                    
                    if(toChoose.length == 0){
                        for(i = 0; i<count; i++){
                            toChoose.push(i);
                        }
                    }
                    var random = toChoose[index];
                    toChoose.splice(index,1);
                   	
			        <!--Set image sizes according to viewport-->
					if (typeof( window.innerHeight ) == 'number' ) {
						var vpHeight = window.innerHeight;
						var vpWidth = window.innerWidth;
					}
					
					var scale = 0.20;
					
					var imgHeight = 0;
                    var imgWidth = 0;
					
                    switch($(this).attr('class')) {
                        case 'tdsmall':
                            source = postsArray[random].smallthumb;
                            tdsmallcount++;
							imgWidth = vpWidth*scale;  
							imgHeight = imgWidth;
                        break;
                        case 'tdbig':
                            source = postsArray[random].bigthumb;
                            tdbigcount++;
							imgWidth = vpWidth*scale*2;  
							imgHeight = imgWidth;
                        break;
                        case 'tdhigh':
                            source = postsArray[random].highthumb;
                            tdhighcount++;
							imgHeight = vpWidth*scale*2;
							imgWidth = imgHeight /2;  
                        break;
                        case 'tdwide':
                            source = postsArray[random].widethumb;
                            tdwidecount++;
							imgWidth = vpWidth*scale*2;  
							imgHeight = imgWidth /2;
                        break;
                    }

                    var linkImg = $('<img/>') // create img
                        .attr({ // set attributes
                            src: source
                    	})
						/*.css({
							width: imgWidth,
							height: imgHeight
						})*/;

                    linkImg.appendTo($(this)); // append to td

			        <!--Add link to the current image for popup-->
					$(this).find('img').each( function() {
						var $img = $(this),
						href = $img.attr('src');
						
						$img.wrap('<a href="'+postsArray[random].fullimg+'" class="top_up"></a>');
					});

                });
				
				<!--Save template size for scroll positionning-->
				chunkHeight = $(classT).height();
				chunkWidth = $(classT).width();

            }
        </script>

    </head>
    
    <body>
        <!-- Add your site or application content here -->
        <div id="thumbs-container">
            <table class="thumbs-table">
                <tr class="masterrow" id="row1">
                    <td class="thumbs-cell" id="td1"></td>
                    <td class="thumbs-cell" id="td2"></td>
                    <td class="thumbs-cell" id="td3"></td>
                </tr>
                
                <tr class="masterrow" id="row2">
                    <td class="thumbs-cell" id="td4"></td>
                    <td class="thumbs-cell" id="td5"></td>
                    <td class="thumbs-cell" id="td6"></td>
                </tr>
                <tr class="masterrow" id="row3">
                    <td class="thumbs-cell" id="td7"></td>
                    <td class="thumbs-cell" id="td8"></td>
                    <td class="thumbs-cell" id="td9"></td>
                </tr>
            </table>
        </div>
        
        <!--Move the viewport to desired element-->
        <script>
            jQuery(document).ready(function() {
                /*var viewportWidth = jQuery(window).width(),
                viewportHeight = jQuery(window).height(),
                $foo = jQuery('#blue'),
                elWidth = $foo.width(),
                elHeight = $foo.height(),
                elOffset = $foo.offset();
                jQuery(window).scrollTop(elOffset.top);
                jQuery(window).scrollLeft(elOffset.left  - (elWidth/2));*/
            });
        </script>
        
        <!--Make the page cyclic. Use a 3x3 grid, to move columns and rows from one side to its opposite.-->
        <script type="text/javascript">
			offset = 100;
            $(window).scroll(function () {
				// When scroll to the bottom
               	if ($(window).scrollTop() + $(window).height() > $(document).height() - offset) {
					var viewTop = $( window ).scrollTop();
					$(".masterrow:first").remove().insertAfter($(".masterrow:last"));
					$( window ).scrollTop( viewTop - chunkHeight );
                }
				
				// When scroll to the top
				if ($(window).scrollTop() < offset) {
					var viewTop = $( window ).scrollTop();
					$(".masterrow:last").remove().insertBefore($(".masterrow:first"));
					$( window ).scrollTop( viewTop + chunkHeight );
                }

				// When scroll to right
               	if ($(window).scrollLeft() + $(window).width() > $(document).width() - offset) {
					var viewLeft = $( window ).scrollLeft();
					var rows = $(".masterrow");
				    var cols;

					rows.each(function() {
						cols = jQuery(this).children('th, td');
						cols.eq(0).detach().insertAfter(cols.eq(2));
					});
					$( window ).scrollLeft( viewLeft - chunkWidth );

				}

				// When scroll to left
				if ($(window).scrollLeft() < offset) {
					var viewLeft= $( window ).scrollLeft();
					var rows = $(".masterrow");
				    var cols;

					rows.each(function() {
						cols = jQuery(this).children('th, td');
						cols.eq(2).detach().insertBefore(cols.eq(0));
					});
					$( window ).scrollLeft( viewLeft + chunkWidth );
                }
            });
        </script>
        
        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <!-- <script>
            var _gaq=[["_setAccount","UA-XXXXX-X"],["_trackPageview"]];
            (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
            g.src=("https:"==location.protocol?"//ssl":"//www")+".google-analytics.com/ga.js";
            s.parentNode.insertBefore(g,s)}(document,"script"));
        </script> -->
    </body>
</html>
